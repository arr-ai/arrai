package syntax

import "testing"

func TestStrContains(t *testing.T) {
	t.Parallel()

	AssertCodesEvalToSameValue(t, `true`, `//seq.contains("A", "A")`)

	AssertCodesEvalToSameValue(t, `true `, `//seq.contains("", "this is a test")             `)
	AssertCodesEvalToSameValue(t, `true `, `//seq.contains("is a test", "this is a test")    `)
	AssertCodesEvalToSameValue(t, `false`, `//seq.contains("is not a test", "this is a test")`)
	AssertCodesEvalToSameValue(t, `false`, `//seq.contains("a is", "this is a test")`)

	AssertCodesEvalToSameValue(t, `true`, `//seq.contains("", "A")`)
	AssertCodesEvalToSameValue(t, `false`, `//seq.contains("A", "")`)
	AssertCodesEvalToSameValue(t, `true`, `//seq.contains("", "")`)

	AssertCodeErrors(t, "", `//seq.contains(1, "ABC")`)
}

func TestArrayContains(t *testing.T) { //nolint:dupl
	t.Parallel()
	AssertCodesEvalToSameValue(t, `true`, `//seq.contains(['A'],['A', 'D','E'])`)
	AssertCodesEvalToSameValue(t, `true`, `//seq.contains(['E'],['A','C','E'])`)
	AssertCodesEvalToSameValue(t, `true`, `//seq.contains(['C'],['B','C','D'])`)

	AssertCodesEvalToSameValue(t, `true`, `//seq.contains(['L','M','N'],['L','M','N','D','E'])`)
	AssertCodesEvalToSameValue(t, `true`, `//seq.contains(['B','C'],['T','B','C','X','Y'])`)
	AssertCodesEvalToSameValue(t, `true`, `//seq.contains(['C','D','E'],['1','3','C','D','E'])`)
	AssertCodesEvalToSameValue(t, `true`, `//seq.contains(['A1','B1','C1','D1','E1'],['A1','B1','C1','D1','E1'])`)
	AssertCodesEvalToSameValue(t, `false`, `//seq.contains(['B1','C2','E3'],['A','B1','C2','D','E3'])`)
	AssertCodesEvalToSameValue(t, `false`, `//seq.contains(['A2','B3','C4','E5'],['A','B','C','D','E'])`)
	AssertCodesEvalToSameValue(t, `false`, `//seq.contains(['A','B','C','D','E','F'],['A','B','C','D','E'])`)

	AssertCodesEvalToSameValue(t, `true`, `//seq.contains(['A1','B2','C3'], ['A', 'A1', 'B2','C3','D','E'])`)
	AssertCodesEvalToSameValue(t, `true`, `//seq.contains(['B4','C5'],['A', 'A', 'B4','C5','D','E'])`)
	AssertCodesEvalToSameValue(t, `true`, `//seq.contains([['B1','C1']],[['A', 'B'], ['B1','C1'],['D','E']])`)

	AssertCodesEvalToSameValue(t, `true`, `//seq.contains([1,2], [1,2,3,4,5])`)
	AssertCodesEvalToSameValue(t, `true`, `//seq.contains([1,2,3,4,5], [1,2,3,4,5])`)
	AssertCodesEvalToSameValue(t, `true`, `//seq.contains([[1,2],[3,4],[5]], [[1,2],[3,4],[5]])`)

	AssertCodesEvalToSameValue(t, `false`, `//seq.contains([1], [])`)
	AssertCodesEvalToSameValue(t, `true`, `//seq.contains([], [1])`)
	AssertCodesEvalToSameValue(t, `true`, `//seq.contains([], [])`)

	AssertCodeErrors(t, "", `//seq.contains(1, [1,2,3,4,5])`)
	AssertCodeErrors(t, "", `//seq.contains('A',['A','B','C','D','E'])`)
}

func TestBytesContains(t *testing.T) {
	t.Parallel()
	// hello bytes - 104 101 108 108 111
	AssertCodesEvalToSameValue(t, `true `, `//seq.contains(<<'hello'>>, <<'hello'>>)                    `)
	AssertCodesEvalToSameValue(t, `true `, `//seq.contains(<<104>>, <<'hello'>>)                        `)
	AssertCodesEvalToSameValue(t, `true `, `//seq.contains(<<111>>, <<'hello'>>)                        `)
	AssertCodesEvalToSameValue(t, `true `, `//seq.contains(<<'h'>>, <<'hello'>>)                        `)
	AssertCodesEvalToSameValue(t, `false`, `//seq.contains(<<'A'>>, <<>>)                               `)
	AssertCodesEvalToSameValue(t, `true `, `//seq.contains({ |@, @byte| (0, 108),(0, 108)}, <<'hello'>>)`)
	AssertCodesEvalToSameValue(t, `true `, `//seq.contains(<<>>, <<>>)                                  `)
	AssertCodesEvalToSameValue(t, `true `, `//seq.contains(<<>>, <<'hello'>>)                           `)
}
